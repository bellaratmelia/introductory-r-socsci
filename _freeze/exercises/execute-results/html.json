{
  "hash": "9ba7748e9df161f62ee33aacb7ffbe8d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Post-workshop exercises\"\nsubtitle: \"Optional exercises to test your knowledge and reinforce your learning\"\nformat: html\n---\n\n\n\n\n## Prep\n\nHave the dplyr, tidyr, and ggplot cheatsheets ready open and ready. \n\n### Load packages\n\nthe code below will load the packages you need:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(car)\n```\n:::\n\n\n\n\n### Load datasets\n\nThe code below will load and print the first few rows of the `Duncan` dataset. To find out more about this dataset, type `?Duncan` in your RStudio console to open the vignette.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nduncan <- as_tibble(Duncan)\nprint(duncan)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 45 × 4\n   type  income education prestige\n   <fct>  <int>     <int>    <int>\n 1 prof      62        86       82\n 2 prof      72        76       83\n 3 prof      75        92       90\n 4 prof      55        90       76\n 5 prof      64        86       90\n 6 prof      21        84       87\n 7 prof      64        93       93\n 8 prof      80       100       90\n 9 wc        67        87       52\n10 prof      72        86       88\n# ℹ 35 more rows\n```\n\n\n:::\n:::\n\n\n\n\nThe code below will load and print the first few rows of the `WVS` dataset. To find out more about this dataset, type `?WVS` in your RStudio console to open the vignette.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwvs <- as_tibble(WVS)\nprint(wvs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5,381 × 6\n   poverty     religion degree country   age gender\n   <ord>       <fct>    <fct>  <fct>   <int> <fct> \n 1 Too Little  yes      no     USA        44 male  \n 2 About Right yes      no     USA        40 female\n 3 Too Little  yes      no     USA        36 female\n 4 Too Much    yes      yes    USA        25 female\n 5 Too Little  yes      yes    USA        39 male  \n 6 About Right yes      no     USA        80 female\n 7 Too Much    yes      no     USA        48 female\n 8 Too Little  yes      no     USA        32 male  \n 9 Too Little  yes      no     USA        74 female\n10 Too Little  yes      no     USA        30 male  \n# ℹ 5,371 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Question 1\n\nUsing `wvs` dataset, filter the `age` column to include values that is more than 29. Then, select the columns `age`, `degree`, `religion` and `poverty`. Save the result to a new dataframe called `wvs_filtered`. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs_filtered <- wvs |> \n    filter(age > 29) |> \n    select(age, degree, religion, poverty) \n\nprint(wvs_filtered)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4,228 × 4\n     age degree religion poverty    \n   <int> <fct>  <fct>    <ord>      \n 1    44 no     yes      Too Little \n 2    40 no     yes      About Right\n 3    36 no     yes      Too Little \n 4    39 yes    yes      Too Little \n 5    80 no     yes      About Right\n 6    48 no     yes      Too Much   \n 7    32 no     yes      Too Little \n 8    74 no     yes      Too Little \n 9    30 no     yes      Too Little \n10    32 yes    yes      Too Little \n# ℹ 4,218 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Question 2\n\nUpdate the `wvs` dataset by creating a dummy-coded version of the `gender` variable, where male = 0 and female = 1. Save the results in a new column named `gender_coded`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs <- wvs |> \n    mutate(gender_coded = if_else(gender == \"male\", 0, 1)) \n\nprint(wvs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5,381 × 7\n   poverty     religion degree country   age gender gender_coded\n   <ord>       <fct>    <fct>  <fct>   <int> <fct>         <dbl>\n 1 Too Little  yes      no     USA        44 male              0\n 2 About Right yes      no     USA        40 female            1\n 3 Too Little  yes      no     USA        36 female            1\n 4 Too Much    yes      yes    USA        25 female            1\n 5 Too Little  yes      yes    USA        39 male              0\n 6 About Right yes      no     USA        80 female            1\n 7 Too Much    yes      no     USA        48 female            1\n 8 Too Little  yes      no     USA        32 male              0\n 9 Too Little  yes      no     USA        74 female            1\n10 Too Little  yes      no     USA        30 male              0\n# ℹ 5,371 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n## Question 3\n\nCreate a summary of the `wvs` dataset showing the number of observations for each country.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> \n    count(country) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 2\n  country       n\n  <fct>     <int>\n1 Australia  1874\n2 Norway     1127\n3 Sweden     1003\n4 USA        1377\n```\n\n\n:::\n:::\n\n\n\n\n## Question 4\n\nUsing `wvs` dataset, calculate the average `age` for each combination of gender and degree status.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> \n    group_by(gender, degree) |> \n    summarise(avg_age = mean(age, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'gender'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n# Groups:   gender [2]\n  gender degree avg_age\n  <fct>  <fct>    <dbl>\n1 female no        45.6\n2 female yes       41.0\n3 male   no        46.0\n4 male   yes       43.3\n```\n\n\n:::\n:::\n\n\n\n\n## Question 5\n\nUsing the `wvs` dataset, create a summary statistics for each country and religion (yes/no). Calculate the `age` mean, `age` median, number of observation.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> \n    group_by(country, religion) %>%\n    summarise(\n        avg_age = mean(age, na.rm = TRUE),\n        median_age = median(age, na.rm = TRUE),\n        n_observations = n()\n    ) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'country'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 5\n# Groups:   country [4]\n  country   religion avg_age median_age n_observations\n  <fct>     <fct>      <dbl>      <dbl>          <int>\n1 Australia no          39.9         37            375\n2 Australia yes         45.7         43           1499\n3 Norway    no          40.6         38            109\n4 Norway    yes         43.6         42           1018\n5 Sweden    no          43.7         42             15\n6 Sweden    yes         43.9         43            988\n7 USA       no          44.6         42            287\n8 USA       yes         48.9         46           1090\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Question 6\n\nUsing the `wvs` dataset, select the 10 oldest respondents from the USA. (hint: `arrange()` and `slice()`)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> \n    filter(country == \"USA\", age > 50) |> \n    arrange(desc(age)) |> \n    slice(1:10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 7\n   poverty     religion degree country   age gender gender_coded\n   <ord>       <fct>    <fct>  <fct>   <int> <fct>         <dbl>\n 1 Too Much    no       no     USA        91 male              0\n 2 Too Little  yes      no     USA        91 male              0\n 3 Too Much    yes      no     USA        88 female            1\n 4 About Right yes      no     USA        88 male              0\n 5 Too Little  yes      yes    USA        87 female            1\n 6 Too Much    yes      no     USA        87 female            1\n 7 Too Little  yes      no     USA        87 male              0\n 8 About Right yes      no     USA        87 male              0\n 9 About Right yes      no     USA        86 female            1\n10 Too Much    yes      no     USA        86 female            1\n```\n\n\n:::\n:::\n\n\n\n\n## Question 7\n\n\nUpdate the `wvs` dataset by adding a new column called `age_category` that categorises each respondents based on the following criteria:\n\n- below 18 = \"youth\" category\n- between 18 to 34 = \"young adult\" category\n- between 35 to 49 = \"adult\" category\n- between 50 to 69 = \"senior\" category\n- more than 70 = \"elderly\" category\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs <- wvs |> \n    mutate(age_category = case_when(\n        age < 18 ~ \"youth\",\n        age >= 18 & age < 35 ~ \"young adult\",\n        age >= 35 & age < 50 ~ \"adult\",\n        age >= 50 & age < 70 ~ \"senior\",\n        age >= 70 ~ \"elderly\"\n    )) \n\nprint(wvs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5,381 × 8\n   poverty     religion degree country   age gender gender_coded age_category\n   <ord>       <fct>    <fct>  <fct>   <int> <fct>         <dbl> <chr>       \n 1 Too Little  yes      no     USA        44 male              0 adult       \n 2 About Right yes      no     USA        40 female            1 adult       \n 3 Too Little  yes      no     USA        36 female            1 adult       \n 4 Too Much    yes      yes    USA        25 female            1 young adult \n 5 Too Little  yes      yes    USA        39 male              0 adult       \n 6 About Right yes      no     USA        80 female            1 elderly     \n 7 Too Much    yes      no     USA        48 female            1 adult       \n 8 Too Little  yes      no     USA        32 male              0 young adult \n 9 Too Little  yes      no     USA        74 female            1 elderly     \n10 Too Little  yes      no     USA        30 male              0 young adult \n# ℹ 5,371 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Question 8\n\nRecreate the following visualization:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> ggplot(aes(x = country, fill = poverty)) +\n    geom_bar(position = \"dodge\") +\n    labs(title = \"Distribution of Poverty Opinions Across Countries\",\n       x = \"Country\", \n       y = \"Count\", \n       fill = \"Poverty Opinion\") +\n    theme_minimal() \n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\n## Question 9\n\nRecreate the following visualization:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> \n    ggplot(aes(x = country, fill = degree)) +\n    geom_bar(position = \"fill\") +\n    labs(title = \"Proportion of Degree Status by Country\", \n       x = \"Country\", y = \"Count\", fill = \"Degree Status\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Question 10\n\nRecreate the following visualization:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> ggplot(aes(x = country, y = age)) +\n    geom_boxplot() +\n    labs(title = \"Age Distribution by Country\", x = \"Country\", y = \"Age\") +\n    theme_minimal() +\n    theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\n## Question 11\n\nRecreate the following visualization:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs |> \n    ggplot(aes(x = country, y = age)) +\n    geom_boxplot() +\n    facet_wrap(~ religion) +\n    labs(title = \"Age Distribution by Country and Religion\",\n       x = \"Country\", y = \"Age\") +\n    theme_minimal() \n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n## Question 12\n\nRecreate the following visualization using `duncan` dataset:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nduncan |> \n    ggplot(aes(x = income, y = prestige, color = type)) +\n    geom_jitter() +\n    labs(title = \"Occupation Prestige vs. Income\",\n       x = \"Income\", \n       y = \"Prestige Score\",\n       color = \"Occupation Type\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n## Question 13\n\nRecreate the following visualization using `duncan` dataset:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nduncan |> \n    ggplot(aes(x = type, y = income)) +\n    geom_boxplot() +\n    labs(title = \"Income Distribution by Occupation Type\",\n        x = \"Occupation Type\",\n        y = \"Income\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n## Question 14\n\nRecreate the following visualization using `duncan` dataset:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nduncan |> \n    ggplot(aes(x = prestige, y = income, color = type)) +\n    geom_jitter() +\n    geom_smooth(method = \"lm\") +\n    labs(\n        title = \"Relationship between Prestige and Income\",\n        subtitle = \"Grouped by Occupation Type\",\n        x = \"Prestige Score\",\n        y = \"Income\",\n        color = \"Occupation Type\"\n    ) + \n    theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n\n## Question 15\n\nUsing `duncan` dataset:\n\n-  Examine the correlation between `prestige` scores and `education`.\n-  Analyze the relationship between `income` and `prestige` scores.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\ncor.test(duncan$prestige, duncan$education)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  duncan$prestige and duncan$education\nt = 10.668, df = 43, p-value = 1.171e-13\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.7445746 0.9163112\nsample estimates:\n      cor \n0.8519156 \n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\ncor.test(duncan$prestige, duncan$income)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  duncan$prestige and duncan$income\nt = 10.062, df = 43, p-value = 7.144e-13\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.7217665 0.9080298\nsample estimates:\n      cor \n0.8378014 \n```\n\n\n:::\n:::\n\n\n\n\n## Question 16\n\nUsing `duncan` dataset, compare prestige scores across different occupational categories using ANOVA.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nduncan_anova <- aov(prestige ~ type, data=duncan)\nsummary(duncan_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ntype         2  33090   16545   65.57 1.21e-13 ***\nResiduals   42  10598     252                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n## Question 17\n\nUsing `duncan` dataset, create a regression model that predicts `income` based on occupational `prestige` and `education` scores.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(huxtable)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nduncan_model <- lm(income ~ prestige + education, data = duncan)\nhuxreg(\"income\" = duncan_model)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<table class=\"huxtable\" data-quarto-disable-processing=\"true\" style=\"border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  \">\n<col><col><tr>\n<th style=\"vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><th style=\"vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">income</th></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(Intercept)</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">10.426 *&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(4.164)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">prestige</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.624 ***</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.125)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">education</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.032&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"></th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">(0.132)&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">N</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">R2</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">0.702&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">logLik</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">-179.902&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">AIC</th><td style=\"vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\">367.805&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>\n<tr>\n<th colspan=\"2\" style=\"vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;\"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>\n</table>\n\n```\n\n:::\n:::\n\n\n\n\n## Question 18\n\nUsing the `wvs` dataset, examine the relationship between `religion` and `poverty` perception.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs_chisq <- chisq.test(table(wvs$religion, wvs$poverty))\nprint(wvs_chisq)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  table(wvs$religion, wvs$poverty)\nX-squared = 0.083005, df = 2, p-value = 0.9593\n```\n\n\n:::\n:::\n\n\n\n\n## Question 19\n\nUsing the wvs dataset, examine whether there is a significant difference in the average age between individuals with and without a university degree.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs_ttest <- t.test(age ~ degree, data = wvs)\nprint(wvs_ttest)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  age by degree\nt = 7.0571, df = 2029, p-value = 2.325e-12\nalternative hypothesis: true difference in means between group no and group yes is not equal to 0\n95 percent confidence interval:\n 2.674321 4.732708\nsample estimates:\n mean in group no mean in group yes \n         45.82775          42.12423 \n```\n\n\n:::\n:::\n\n\n\n\n## Question 20\n\nUsing `wvs` dataset, compare the mean of age across different countries and age categories **(see Question 7 to create age_category)**, and investigate if there is any significant difference. Conduct the post-hoc test if needed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show Answer\"}\nwvs_anova <- aov(age ~ country + age_category, data = wvs)\nsummary(wvs_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df  Sum Sq Mean Sq F value Pr(>F)    \ncountry         3   17399    5800   235.9 <2e-16 ***\nage_category    3 1424858  474953 19319.9 <2e-16 ***\nResiduals    5374  132113      25                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n",
    "supporting": [
      "exercises_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}